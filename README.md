# Документација на проектот

Проектот е Windows Forms апликација, односно игра изработена целосно во C#. Главната цел на играта е корисникот да има интерактивно искуство при сместување на блоковите, преку кои што гради вид на кула, при што поентата е да се изгради што е можно повисока кула. Механиките на играта ги провоцираат рефлексите и прецизноста на корисникот со тоа што наградуваат прецизно поставување на блоковите. Инспирацијата е добиена од играта Stack создадена од Ketchapp (https://www.youtube.com/watch?v=62wMiyt82ng)

## Опис и инструкции за играта

Играта почнува со еден статичен блок и еден блок кој што се мрда хоризонтално со иста широчина. Со клик на Space или лев клик на глувчето, блокот што се движи се поставува врз статичниот блок и поентата е да се постигне што е можно подобро преклопување. Со секое поставување на блок еден врз друг, се добива 1 поен, но ако поставениот блок има беспрекорно преклопување се добиваат 2 поени. Големината на секој последователен блок зависи од колку добро бил поставен претходниот блок, што значи дека доколку е перфектно поставен некој блок, следниот е од иста големина, но доколку не е, следниот е од толкава големина колку што било поклопувањето на претходниот со тој под него (статичниот). Кога поставениот блок нема никакво поклопување со претходниот, играта завршува и тоа е крајниот резултат. На овој начин се гради кула и поените (резултатот) всушност одредуваат колку е висока таа кула. Youtube link до видеото за опис на играта: https://youtu.be/bLy2tK7XZaw

## Главни функционалности

- Почеток и рестарт со клик на копче
- Прогрес во вид на инкрементирање поени
- Наградување на перфектно поставување на блок
- Чување највисок постигнат резултат
- Зголемување на брзината на движењето на блоковите со тек на време
- Автоматско вертикално следење на актуелен статички блок при надминат одреден threshold
- Центрирање на статичкиот блок при хоризонтално проширување на прозорецот, овозможувајќи полесно поставување на блок

## Чување на податоци, класи, функции

**Следење на поени:**
 `int score`: Тековни поени од играта.
`int highScore`: Највисок поен постигнат во сите сесии.

**Управување со блокови:**
Stack  се користи за чување на сите поставени блокови.
Секој блок се црта со одредена боја (`Color`).


**Состојба на играта:**
Boolean знаци како  `isGameRunning`  покажуваат дали играта е активна.

**Тајмери:**
`gameTimer`: Ја контролира брзината на движење и поставување на блоковите.

**Графика:**
Користи GDI+ (објект  `Graphics`) во настанот  `Paint`  за да ги прикаже блоковите на формата.

**Класи и структури:**

**GameForm (Главна класа):**
Методот  `PlaceBlock()`  е основниот механизам на играта со наголемување на блокови. Тој го одредува:

-   Дали новиот подвижен блок се преклопува со претходниот блок.
-   Ги прилагодува големината и позицијата на блокот врз основа на преклопувањето.
-   Детектира совршено поставување (со толеранција).
-   Ги ажурира поените, брзината и состојбата на играта.
-   Го завршува играта ако нема преклопување.

1. `if (gameOver) return;`
-   Доколку играта е завршена, функцијата не вади
-   Превентира нови блокови да се создаваат и поставуваат ако сме завршиле
2. `if (showInstructions) showInstructions = false;`
- Упатствата („Притисни Space / Кликни за поставување“) се прикажуваат само пред првиот потег.  
- Откако играчот ќе постави блок, тие исчезнуваат.
3. `RectangleF prev = stack.Last();`
- Го добива последниот поставен блок од листата `stack`.  
- Новиот блок ќе се постави во однос на овој блок.
4. `float overlapLeft = Math.Max(prev.Left, moveX);
float overlapRight = Math.Min(prev.Right, moveX + moveWidth);
float overlapWidth = overlapRight - overlapLeft;`

- Го одредува хоризонталното преклопување помеѓу подвижниот блок и претходниот блок.  
`overlapWidth` е ширината на заедничката област:  
- Ако `overlapWidth <= 0f`, нема преклопување, што значи дека блокот е целосно надвор → крај на играта.
5. `if (overlapWidth <= 0f)
{
    gameOver = true;
    timer.Stop();
    Invalidate();
    return;
}`
- Ако нема преклопување, играчот губи.  
- Го запира тајмерот на играта и ја прави формата да прикаже крај на играта.
6. float blockHeight = prev.Height;
var placed = new RectangleF(overlapLeft, moveY, overlapWidth, blockHeight);
- Создава нов блок (`placed`) со:
-   `X`: Левата ивица на преклопувањето.
-   `Y`: Тековната Y-позиција на подвижниот блок (`moveY`).
-   `Width`: Иста како ширината на преклопувањето.
-   `Height`: Иста како претходниот блок.
7. `bool isPerfect = Math.Abs(moveX - prev.X) <= perfectTolerance;`
- Го споредува X-позицијата на подвижниот блок со претходниот блок.  
- Ако разликата е во рамките на `perfectTolerance` (4 пиксели), поставувањето се смета за совршено.
8. `stack.Add(placed);`
colors.Add(NextColor());
- Ги додава новите блокови во листата `stack`.  
- Му доделува нова боја на блокот од функцијата `NextColor()`.  
9. `if (isPerfect)
{
    score += 2;
    statusText = "PERFECT!";
    statusTimer = 25;
}
else
{
    score++;
}`
- Ако е совршено:
	Доделува +2 поени.
    Прикажува „PERFECT!“ за кратко време (`statusTimer`  ја контролира должината на прикажување).
- Во спротивно:
	Доделува +1 поен.
10. `moveWidth = overlapWidth;
moveY -= blockHeight;`
- Ja намалува ширината на следниот подвижен блок на новата прилагодена големина.  
- Ja поместува Y-позицијата нагоре за следниот блок.
11. `float topY = moveY;
if (topY < ClientSize.Height * 0.25f)
{
    float shift = (ClientSize.Height * 0.25f) - topY;
    for (int i = 0; i < stack.Count; i++)
    {
        var r = stack[i];
        r.Y += shift;
        stack[i] = r;
    }
    moveY += shift;
}`
- Ако стекот ja достигне горната четвртина од екранот, ги поместува сите блокови надолу.  
- Го одржува видливото подрачје за играње додека стекот расте.
12. `dir = -dir;
speed = Math.Min(speed + 0.12f, 12f);
moveX = dir > 0 ? 0 : Math.Max(0, ClientSize.Width - moveWidth);`
- Следниот блок почнува да се движи во спротивна насока.  
- Брзината малку се зголемува (до максимум 12).  
- `moveX` се ресетира за да започне од правилната страна на екранот.

## Користење на Generative AI

За Generative AI беше користен ChatGPT 4o на тој начин што го копирав и прикачив веќе напишаниот код со цел да има контекст и користев нешто како следниве prompt-ови:

- You are a senior Game Developer. I want you to generate a method in C# for System.Drawing.Graphics to draw rounded rectangles in order to fit in with the previously pasted code.

-  You are a senior Game Developer. I want you to generate a  OnPaint override for this stacking game: draw background, colored stacked rectangles with rounded corners, moving rectangle if game not over, score, high score, gold status text, and control instructions in order to fit in with the pasted code
